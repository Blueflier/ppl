# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## What is PPL

AI-powered social event concierge for SF. Users share interests → AI matches people, picks times/venues → surfaces invites. No organizers — AI is the invisible host. Full spec: `docs/SPEC.md`.

## Tech Stack

- **Frontend**: Next.js 16 (App Router), React 19, TypeScript, Tailwind CSS v4
- **Backend**: Convex (database, queries, mutations, actions, scheduled functions)
- **AI**: Anthropic Claude API (`claude-sonnet-4-6`) via `@anthropic-ai/sdk`
- **Auth**: Phone + SMS OTP via Twilio (custom, no auth library)
- **Calendar**: Google Calendar OAuth via `googleapis`
- **Venues**: Google Places API via `@googlemaps/google-maps-services-js`
- **Matching**: PyTorch service served via Next.js API route
- **Package manager**: pnpm

## Commands

```bash
pnpm dev              # Next.js dev server
pnpm build            # Production build
pnpm lint             # ESLint
npx convex dev        # Convex dev server + codegen (run alongside pnpm dev)
```

## Project Structure

```
src/app/              # Next.js App Router pages and layouts
convex/               # Convex backend: schema, queries, mutations, actions
convex/_generated/    # Auto-generated by Convex — DO NOT EDIT
docs/SPEC.md          # Product spec — source of truth for features and schema
```

Path alias: `@/*` → `./src/*`

## Convex Conventions

- Schema defined in `convex/schema.ts`
- Functions use `query`, `mutation`, `action` from `convex/_generated/server`
- Validators use `v` from `convex/values`
- Reference functions via `api.module.functionName` (public) or `internal.module.functionName` (internal)
- Actions with external API calls need `"use node"` directive at top of file
- HTTP endpoints use `httpAction` routed via `convex/http.ts`
- Auto-generated files regenerate on `npx convex dev` — never hand-edit `convex/_generated/`

## Styling

- Tailwind CSS v4 — no `tailwind.config.js`; configured via `@import "tailwindcss"` and `@theme inline` in `globals.css`
- PostCSS plugin: `@tailwindcss/postcss`
- CSS variables for theming (supports dark mode via `prefers-color-scheme`)
- Fonts: Geist Sans + Geist Mono loaded via `next/font/google`

## Navigation Structure

```
Bottom tabs: [ Explore ] [ Ideate ] [ Me ]
Explore → top tabs: [ For You ] [ Friends ]
```

## Key Architecture Decisions

- Convex handles all DB, real-time subscriptions, and server-side logic (no separate REST API)
- Claude Ideate chat: one ongoing conversation per user, history stored in `ideateLogs` table (last 10 messages)
- Claude extracts structured interest JSON: `{ category, canonicalValue, rawValue, inferredContext }`
- RSVP cards ordered by soonest deadline
- Event lifecycle: gauging → pending_rsvp → confirmed → completed/cancelled
- SF-only for MVP
